> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [www.v2ex.com](https://www.v2ex.com/t/823321)

最近入手了一台 J4125 工控机，底层 ESXi ，虚拟机安装了 iKuai 和 OpenWrt ，替换了原来的京东（主路由）+N1 （旁路由），折腾了半天终于调通了网络，顺便梳理一下我家的网络拓扑。 ![](https://pic.shua1zh.top:5505/images/2021/12/20/d5a43badc852cecb08df52e3bc41cff2.png)

好多人疑问为什么软路由出来的网线要接到交换机（ iKuai 的 lan1 出来的）上，我来说一下。

1 ，首先四个网卡，都做了直通。

2 ，网卡 1 ，网卡 2 分配给了 iKuai ，网卡 1 （ eth0 ）当作 wan 口，连接光猫拨号；网卡 2 （ eth1 ）当作 lan 口，做 DHCP ，出来接交换机。网卡 3 做 openwrt （ eth2 ）；网卡 4 （ eth3 ）做为 esxi 的管理口。

3 ，因为网卡做了直通，所以一台软路由相当于三个独立设备了（网络方面），如果 esxi ，op 的网口不插网线，那么局域网设备是无法访问它们的，因为没插网线啊（我删除了他们的虚拟网卡）。

4 ，所以把 esxi 和 op 插上网线，接到 lan1 出来的交换机上，就加入局域网了，都可以访问了。

不过我觉得 4 个网卡都装在同一个主板上，按理说内部就可以通信，不要外部接线，但是我没找到解决办法，只能互相接线了，我自己命名叫直通网卡回流，可能不准确，见谅！